# å¢¨ç‘œä¼½çº¦è¯¾ç³»ç»Ÿ - æµ‹è¯•æŒ‡å—

## ðŸ§ª æµ‹è¯•æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å…¨é¢æµ‹è¯•å¢¨ç‘œä¼½çº¦è¯¾ç³»ç»Ÿçš„å„é¡¹åŠŸèƒ½ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œã€‚

## ðŸ“‹ æµ‹è¯•å‡†å¤‡

### 1. çŽ¯å¢ƒæ£€æŸ¥æ¸…å•

- [ ] äº‘å¼€å‘çŽ¯å¢ƒå·²å¼€é€šå¹¶é…ç½®
- [ ] æ‰€æœ‰äº‘å‡½æ•°å·²éƒ¨ç½²æˆåŠŸ
- [ ] æ•°æ®åº“é›†åˆå·²åˆ›å»º
- [ ] æƒé™è§„åˆ™å·²è®¾ç½®
- [ ] ç®¡ç†å‘˜è´¦æˆ·å·²åˆ›å»º

### 2. æµ‹è¯•è´¦å·å‡†å¤‡

#### ç®¡ç†å‘˜è´¦å·
- åœ¨ `admins` é›†åˆä¸­æ·»åŠ æ‚¨çš„ openid
- æ›´æ–° `app.js` ä¸­çš„ `adminList`

#### æµ‹è¯•ç”¨æˆ·è´¦å·
- å‡†å¤‡ 2-3 ä¸ªå¾®ä¿¡è´¦å·ç”¨äºŽæµ‹è¯•
- ç¡®ä¿èƒ½å¤Ÿæ­£å¸¸ç™»å½•å°ç¨‹åº

## ðŸŽ¯ åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹

### ç”¨ä¾‹1ï¼šç”¨æˆ·æ³¨å†Œç™»å½•

#### æµ‹è¯•æ­¥éª¤ï¼š
1. ä½¿ç”¨æµ‹è¯•è´¦å·è¿›å…¥å°ç¨‹åº
2. è¿›å…¥"ä¸ªäººä¸­å¿ƒ"é¡µé¢
3. ç‚¹å‡»"èŽ·å–ç”¨æˆ·ä¿¡æ¯"æŒ‰é’®
4. æŽˆæƒèŽ·å–ç”¨æˆ·ä¿¡æ¯

#### é¢„æœŸç»“æžœï¼š
- ç”¨æˆ·ä¿¡æ¯æˆåŠŸèŽ·å–
- `users` é›†åˆä¸­æ–°å¢žç”¨æˆ·è®°å½•
- æ˜¾ç¤ºåˆå§‹æ¬¡å¡ä½™é¢ï¼ˆ0æ¬¡ï¼‰

#### éªŒè¯æ–¹æ³•ï¼š
```javascript
// åœ¨äº‘å¼€å‘æŽ§åˆ¶å°æ•°æ®åº“ä¸­æŸ¥è¯¢
db.collection('users').where({
  openid: 'user-openid'
}).get()
```

### ç”¨ä¾‹2ï¼šç®¡ç†å‘˜æ·»åŠ è¯¾ç¨‹

#### æµ‹è¯•æ­¥éª¤ï¼š
1. ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•
2. åœ¨ä¸ªäººä¸­å¿ƒé•¿æŒ‰æˆ–ç‰¹æ®Šæ‰‹åŠ¿è¿›å…¥ç®¡ç†åŽå°
3. ç‚¹å‡»"è¯¾ç¨‹ç®¡ç†"
4. åœ¨"æ·»åŠ è¯¾ç¨‹"æ ‡ç­¾ä¸‹å¡«å†™è¯¾ç¨‹ä¿¡æ¯ï¼š
   - è¯¾ç¨‹åç§°ï¼šæµç‘œä¼½
   - è¯¾ç¨‹ç±»åž‹ï¼šå›¢è¯¾
   - æŽˆè¯¾è€å¸ˆï¼šèŽ¹å„¿
   - è¯¾ç¨‹æè¿°ï¼šå‘¼å¸ï¼ŒæµåŠ¨ï¼Œä½“å¼
   - æœ€å¤§äººæ•°ï¼š8
   - æœ€å°‘äººæ•°ï¼š2
   - æ¶ˆè€—æ¬¡å¡ï¼š1
   - è¯¾ç¨‹æ—¶é•¿ï¼š60åˆ†é’Ÿ
5. ç‚¹å‡»"åˆ›å»ºè¯¾ç¨‹"

#### é¢„æœŸç»“æžœï¼š
- æ˜¾ç¤º"è¯¾ç¨‹åˆ›å»ºæˆåŠŸ"
- `courses` é›†åˆä¸­æ–°å¢žè¯¾ç¨‹è®°å½•
- è¡¨å•è‡ªåŠ¨é‡ç½®

### ç”¨ä¾‹3ï¼šç®¡ç†å‘˜å®‰æŽ’è¯¾ç¨‹æ—¥ç¨‹

#### æµ‹è¯•æ­¥éª¤ï¼š
1. åœ¨è¯¾ç¨‹ç®¡ç†é¡µé¢åˆ‡æ¢åˆ°"å®‰æŽ’æ—¥ç¨‹"æ ‡ç­¾
2. å¡«å†™æ—¥ç¨‹ä¿¡æ¯ï¼š
   - é€‰æ‹©è¯¾ç¨‹ï¼šæµç‘œä¼½
   - æŽˆè¯¾è€å¸ˆï¼šèŽ¹å„¿
   - è¯¾ç¨‹æ—¥æœŸï¼šæ˜Žå¤©
   - å¼€å§‹æ—¶é—´ï¼š19:15
   - ç»“æŸæ—¶é—´ï¼š20:15
   - æœ€å¤§äººæ•°ï¼š8
   - æœ€å°‘äººæ•°ï¼š2
3. ç‚¹å‡»"å®‰æŽ’è¯¾ç¨‹"

#### é¢„æœŸç»“æžœï¼š
- æ˜¾ç¤º"è¯¾ç¨‹å®‰æŽ’æˆåŠŸ"
- `courseSchedule` é›†åˆä¸­æ–°å¢žæ—¥ç¨‹è®°å½•

### ç”¨ä¾‹4ï¼šç®¡ç†å‘˜å……å€¼ç”¨æˆ·æ¬¡å¡

#### æµ‹è¯•æ­¥éª¤ï¼š
1. è¿›å…¥"ç”¨æˆ·ç®¡ç†"é¡µé¢
2. æœç´¢æˆ–æ‰¾åˆ°æµ‹è¯•ç”¨æˆ·
3. ç‚¹å‡»ç”¨æˆ·ï¼Œæ‰“å¼€ç¼–è¾‘å¼¹çª—
4. è®¾ç½®æ“ä½œç±»åž‹ä¸º"å¢žåŠ "
5. å›¢è¯¾æ¬¡å¡ï¼š10
6. æ“ä½œè¯´æ˜Žï¼šæµ‹è¯•å……å€¼
7. ç‚¹å‡»"ç¡®è®¤ä¿®æ”¹"

#### é¢„æœŸç»“æžœï¼š
- æ˜¾ç¤º"ä¿®æ”¹æˆåŠŸ"
- ç”¨æˆ·æ¬¡å¡ä½™é¢æ›´æ–°ä¸º10æ¬¡
- `adminLogs` é›†åˆä¸­è®°å½•æ“ä½œæ—¥å¿—

### ç”¨ä¾‹5ï¼šç”¨æˆ·é¢„çº¦è¯¾ç¨‹

#### æµ‹è¯•æ­¥éª¤ï¼š
1. åˆ‡æ¢åˆ°æ™®é€šç”¨æˆ·è´¦å·
2. è¿›å…¥"è¯¾ç¨‹"é¡µé¢
3. æŸ¥çœ‹ä»Šæ—¥è¯¾ç¨‹åˆ—è¡¨
4. ç‚¹å‡»"ç«‹å³é¢„çº¦"æŒ‰é’®

#### é¢„æœŸç»“æžœï¼š
- æ˜¾ç¤º"é¢„çº¦æˆåŠŸ"
- ç”¨æˆ·æ¬¡å¡ä½™é¢å‡å°‘1æ¬¡
- `bookings` é›†åˆä¸­æ–°å¢žé¢„çº¦è®°å½•
- è¯¾ç¨‹æ˜¾ç¤ºçŠ¶æ€æ›´æ–°

### ç”¨ä¾‹6ï¼šç­‰ä½åŠŸèƒ½æµ‹è¯•

#### æµ‹è¯•æ­¥éª¤ï¼š
1. ä½¿ç”¨å¤šä¸ªè´¦å·é¢„çº¦åŒä¸€è¯¾ç¨‹
2. å½“é¢„çº¦äººæ•°è¾¾åˆ°ä¸Šé™æ—¶
3. ç»§ç»­ä½¿ç”¨æ–°è´¦å·é¢„çº¦

#### é¢„æœŸç»“æžœï¼š
- å‰8ä¸ªç”¨æˆ·çŠ¶æ€ä¸º"å·²é¢„çº¦"
- ç¬¬9ä¸ªç”¨æˆ·çŠ¶æ€ä¸º"ç­‰ä½ä¸­ ç¬¬1ä½"
- è¯¾ç¨‹æ˜¾ç¤º"å·²æ»¡ï½œ1äººç­‰ä½"

### ç”¨ä¾‹7ï¼šå–æ¶ˆé¢„çº¦æµ‹è¯•

#### æµ‹è¯•æ­¥éª¤ï¼š
1. å·²é¢„çº¦ç”¨æˆ·ç‚¹å‡»"å–æ¶ˆé¢„çº¦"
2. ç¡®è®¤å–æ¶ˆæ“ä½œ

#### é¢„æœŸç»“æžœï¼š
- æ˜¾ç¤º"å–æ¶ˆé¢„çº¦æˆåŠŸ"
- æ¬¡å¡é€€è¿˜åˆ°è´¦æˆ·
- ç­‰ä½ç”¨æˆ·è‡ªåŠ¨è½¬ä¸ºæ­£å¼é¢„çº¦
- å‘é€é€šçŸ¥ç»™è½¬æ­£ç”¨æˆ·

### ç”¨ä¾‹8ï¼šè¯¾ç¨‹æé†’æµ‹è¯•

#### æµ‹è¯•æ­¥éª¤ï¼š
1. åˆ›å»º1å°æ—¶åŽå¼€å§‹çš„è¯¾ç¨‹
2. ç­‰å¾…å®šæ—¶å™¨è§¦å‘ï¼ˆå¯æ‰‹åŠ¨è°ƒç”¨äº‘å‡½æ•°ï¼‰

#### é¢„æœŸç»“æžœï¼š
- å·²é¢„çº¦ç”¨æˆ·æ”¶åˆ°è¯¾ç¨‹æé†’é€šçŸ¥
- `notifications` é›†åˆä¸­æ–°å¢žé€šçŸ¥è®°å½•

## ðŸ“Š ç¤ºä¾‹æµ‹è¯•æ•°æ®

### 1. åˆ›å»ºæµ‹è¯•è¯¾ç¨‹

```javascript
// åœ¨äº‘å¼€å‘æŽ§åˆ¶å°æ‰§è¡Œ
const testCourses = [
  {
    title: "æµç‘œä¼½",
    type: "group",
    teacherId: "teacher1",
    teacherName: "èŽ¹å„¿",
    description: "å‘¼å¸ï¼ŒæµåŠ¨ï¼Œä½“å¼ã€‚é€‚åˆæ‰€æœ‰çº§åˆ«çš„å­¦å‘˜",
    maxStudents: 8,
    minStudents: 2,
    price: 1,
    duration: 60,
    status: "active",
    createTime: new Date(),
    updateTime: new Date()
  },
  {
    title: "å¥³æ€§ç‘œä¼½",
    type: "group", 
    teacherId: "teacher1",
    teacherName: "èŽ¹å„¿",
    description: "ä¸“ä¸ºå¥³æ€§è®¾è®¡çš„ç‘œä¼½è¯¾ç¨‹",
    maxStudents: 6,
    minStudents: 2,
    price: 1,
    duration: 75,
    status: "active",
    createTime: new Date(),
    updateTime: new Date()
  }
];

// æ‰¹é‡æ’å…¥è¯¾ç¨‹
testCourses.forEach(async (course) => {
  await db.collection('courses').add({ data: course });
});
```

### 2. åˆ›å»ºæµ‹è¯•æ—¥ç¨‹

```javascript
// èŽ·å–æ˜Žå¤©çš„æ—¥æœŸ
const tomorrow = new Date();
tomorrow.setDate(tomorrow.getDate() + 1);
const dateStr = tomorrow.toISOString().split('T')[0];

const testSchedules = [
  {
    courseId: "ä½ çš„è¯¾ç¨‹ID", // æ›¿æ¢ä¸ºå®žé™…è¯¾ç¨‹ID
    teacherId: "teacher1",
    teacherName: "èŽ¹å„¿",
    date: dateStr,
    startTime: "09:00",
    endTime: "10:00",
    maxStudents: 8,
    minStudents: 2,
    currentStudents: 0,
    status: "published",
    createTime: new Date()
  },
  {
    courseId: "ä½ çš„è¯¾ç¨‹ID", // æ›¿æ¢ä¸ºå®žé™…è¯¾ç¨‹ID
    teacherId: "teacher1", 
    teacherName: "èŽ¹å„¿",
    date: dateStr,
    startTime: "19:15",
    endTime: "20:15",
    maxStudents: 8,
    minStudents: 2,
    currentStudents: 0,
    status: "published",
    createTime: new Date()
  }
];

// æ‰¹é‡æ’å…¥æ—¥ç¨‹
testSchedules.forEach(async (schedule) => {
  await db.collection('courseSchedule').add({ data: schedule });
});
```

### 3. åˆ›å»ºæµ‹è¯•ç”¨æˆ·

```javascript
const testUsers = [
  {
    openid: "test-user-1",
    nickName: "æµ‹è¯•ç”¨æˆ·1",
    avatarUrl: "",
    phone: "13800138001",
    groupCredits: 10,
    termCredits: 5,
    totalClasses: 0,
    createTime: new Date(),
    updateTime: new Date()
  },
  {
    openid: "test-user-2", 
    nickName: "æµ‹è¯•ç”¨æˆ·2",
    avatarUrl: "",
    phone: "13800138002",
    groupCredits: 5,
    termCredits: 3,
    totalClasses: 0,
    createTime: new Date(),
    updateTime: new Date()
  }
];

// æ‰¹é‡æ’å…¥ç”¨æˆ·
testUsers.forEach(async (user) => {
  await db.collection('users').add({ data: user });
});
```

## ðŸ” æµ‹è¯•éªŒè¯æ–¹æ³•

### 1. æ•°æ®åº“æŸ¥è¯¢éªŒè¯

```javascript
// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ­£ç¡®åˆ›å»º
db.collection('users').where({
  nickName: 'æµ‹è¯•ç”¨æˆ·1'
}).get().then(res => {
  console.log('ç”¨æˆ·æ•°æ®:', res.data);
});

// æ£€æŸ¥é¢„çº¦è®°å½•
db.collection('bookings').where({
  userId: 'user-openid'
}).get().then(res => {
  console.log('é¢„çº¦è®°å½•:', res.data);
});

// æ£€æŸ¥è¯¾ç¨‹å®‰æŽ’
db.collection('courseSchedule').where({
  date: '2025-07-08'
}).get().then(res => {
  console.log('è¯¾ç¨‹å®‰æŽ’:', res.data);
});
```

### 2. äº‘å‡½æ•°è°ƒè¯•

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æŽ§åˆ¶å°ä¸­æµ‹è¯•äº‘å‡½æ•°ï¼š

```javascript
// æµ‹è¯•èŽ·å–è¯¾ç¨‹å®‰æŽ’
wx.cloud.callFunction({
  name: 'getDaySchedule',
  data: {
    date: '2025-07-08'
  }
}).then(res => {
  console.log('è¯¾ç¨‹å®‰æŽ’ç»“æžœ:', res.result);
});

// æµ‹è¯•é¢„çº¦è¯¾ç¨‹
wx.cloud.callFunction({
  name: 'bookCourse',
  data: {
    scheduleId: 'your-schedule-id'
  }
}).then(res => {
  console.log('é¢„çº¦ç»“æžœ:', res.result);
});
```

## âš ï¸ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šäº‘å‡½æ•°è°ƒç”¨å¤±è´¥

**ç—‡çŠ¶**ï¼šäº‘å‡½æ•°è¿”å›žé”™è¯¯æˆ–è¶…æ—¶

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥äº‘çŽ¯å¢ƒIDæ˜¯å¦æ­£ç¡®
2. ç¡®è®¤äº‘å‡½æ•°éƒ¨ç½²æˆåŠŸ
3. æŸ¥çœ‹äº‘å‡½æ•°æ‰§è¡Œæ—¥å¿—
4. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥

### é—®é¢˜2ï¼šæ•°æ®åº“æƒé™é”™è¯¯

**ç—‡çŠ¶**ï¼šæ•°æ®åº“æ“ä½œè¢«æ‹’ç»

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥æ•°æ®åº“æƒé™è®¾ç½®
2. ç¡®è®¤ç”¨æˆ·å·²æ­£ç¡®ç™»å½•
3. éªŒè¯ openid èŽ·å–æ˜¯å¦æ­£å¸¸

### é—®é¢˜3ï¼šç”¨æˆ·ä¿¡æ¯èŽ·å–å¤±è´¥

**ç—‡çŠ¶**ï¼šæ— æ³•èŽ·å–ç”¨æˆ·æ˜µç§°å’Œå¤´åƒ

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `wx.getUserProfile` è°ƒç”¨
2. ç¡®è®¤ç”¨æˆ·å·²æŽˆæƒ
3. æ£€æŸ¥äº‘å‡½æ•°ä¸­çš„ç”¨æˆ·æ³¨å†Œé€»è¾‘

### é—®é¢˜4ï¼šé¢„çº¦çŠ¶æ€ä¸æ­£ç¡®

**ç—‡çŠ¶**ï¼šé¢„çº¦åŽçŠ¶æ€æ˜¾ç¤ºå¼‚å¸¸

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥äº‹åŠ¡å¤„ç†é€»è¾‘
2. éªŒè¯æ•°æ®åº“æ›´æ–°æ“ä½œ
3. ç¡®è®¤å‰ç«¯é¡µé¢åˆ·æ–°æœºåˆ¶

### é—®é¢˜5ï¼šç®¡ç†å‘˜åŠŸèƒ½æ— æ³•è®¿é—®

**ç—‡çŠ¶**ï¼šç®¡ç†å‘˜é¡µé¢æ˜¾ç¤ºæ— æƒé™

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ç®¡ç†å‘˜ openid é…ç½®
2. ç¡®è®¤ `admins` é›†åˆä¸­çš„è®°å½•
3. éªŒè¯æƒé™æ£€æŸ¥é€»è¾‘

## ðŸ“ˆ æ€§èƒ½æµ‹è¯•

### 1. å¹¶å‘é¢„çº¦æµ‹è¯•

æ¨¡æ‹Ÿå¤šç”¨æˆ·åŒæ—¶é¢„çº¦åŒä¸€è¯¾ç¨‹ï¼š

```javascript
// åˆ›å»ºå¹¶å‘æµ‹è¯•è„šæœ¬
const concurrentBooking = async () => {
  const promises = [];
  for (let i = 0; i < 10; i++) {
    promises.push(
      wx.cloud.callFunction({
        name: 'bookCourse',
        data: { scheduleId: 'test-schedule-id' }
      })
    );
  }
  
  const results = await Promise.all(promises);
  console.log('å¹¶å‘é¢„çº¦ç»“æžœ:', results);
};
```

### 2. å¤§æ•°æ®é‡æµ‹è¯•

æµ‹è¯•ç³»ç»Ÿåœ¨å¤§é‡æ•°æ®ä¸‹çš„æ€§èƒ½ï¼š

```javascript
// æ‰¹é‡åˆ›å»ºæµ‹è¯•æ•°æ®
const createBulkData = async () => {
  const batchSize = 100;
  const batches = [];
  
  for (let i = 0; i < batchSize; i++) {
    batches.push({
      // æµ‹è¯•æ•°æ®ç»“æž„
    });
  }
  
  // åˆ†æ‰¹æ’å…¥
  for (let i = 0; i < batches.length; i += 20) {
    const batch = batches.slice(i, i + 20);
    await db.collection('testCollection').add({ data: batch });
  }
};
```

## âœ… æµ‹è¯•å®Œæˆæ¸…å•

- [ ] ç”¨æˆ·æ³¨å†Œç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] ç®¡ç†å‘˜æƒé™éªŒè¯æ­£ç¡®
- [ ] è¯¾ç¨‹åˆ›å»ºåŠŸèƒ½æ­£å¸¸
- [ ] è¯¾ç¨‹æ—¥ç¨‹å®‰æŽ’åŠŸèƒ½æ­£å¸¸
- [ ] ç”¨æˆ·æ¬¡å¡ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] è¯¾ç¨‹é¢„çº¦åŠŸèƒ½æ­£å¸¸
- [ ] ç­‰ä½åŠŸèƒ½æ­£å¸¸
- [ ] å–æ¶ˆé¢„çº¦åŠŸèƒ½æ­£å¸¸
- [ ] é€šçŸ¥ç³»ç»Ÿæ­£å¸¸
- [ ] å®šæ—¶æé†’åŠŸèƒ½æ­£å¸¸
- [ ] æ•°æ®ä¸€è‡´æ€§ä¿è¯
- [ ] æƒé™æŽ§åˆ¶æœ‰æ•ˆ
- [ ] æ€§èƒ½è¡¨çŽ°è‰¯å¥½

## ðŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

### æµ‹è¯•çŽ¯å¢ƒ
- äº‘çŽ¯å¢ƒIDï¼š
- æµ‹è¯•æ—¶é—´ï¼š
- æµ‹è¯•äººå‘˜ï¼š

### æµ‹è¯•ç»“æžœ
| åŠŸèƒ½æ¨¡å— | æµ‹è¯•çŠ¶æ€ | é—®é¢˜æè¿° | è§£å†³æ–¹æ¡ˆ |
|---------|---------|---------|---------|
| ç”¨æˆ·ç™»å½• | âœ… é€šè¿‡ | - | - |
| è¯¾ç¨‹ç®¡ç† | âœ… é€šè¿‡ | - | - |
| é¢„çº¦ç³»ç»Ÿ | âš ï¸ éƒ¨åˆ†é€šè¿‡ | å¹¶å‘é—®é¢˜ | å·²ä¿®å¤ |

### æ€§èƒ½æŒ‡æ ‡
- é¡µé¢åŠ è½½æ—¶é—´ï¼š< 2ç§’
- äº‘å‡½æ•°å“åº”æ—¶é—´ï¼š< 500ms
- æ•°æ®åº“æŸ¥è¯¢æ—¶é—´ï¼š< 100ms

---

*å®Œæˆæ‰€æœ‰æµ‹è¯•åŽï¼Œæ‚¨çš„çº¦è¯¾ç³»ç»Ÿå°±å¯ä»¥æ­£å¼ä¸Šçº¿ä½¿ç”¨äº†ï¼*
