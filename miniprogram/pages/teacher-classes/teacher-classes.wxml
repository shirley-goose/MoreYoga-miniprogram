<!-- è€å¸ˆè¯¾ç¨‹é¡µé¢ -->
<!-- èƒŒæ™¯å›¾ -->
<image class="global-bg" src="cloud://cloud1-9g5oms9v90aabf59.636c-cloud1-9g5oms9v90aabf59-1374796372/background.png" mode="aspectFill"/>

<!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
<view class="nav-bar">
  <view class="nav-left">
    <view class="back-btn" bindtap="goBack">
      <view class="back-icon">â†</view>
    </view>
  </view>
  <view class="nav-center">
    <view class="nav-title">æˆ‘çš„è¯¾ç¨‹</view>
  </view>
  <view class="nav-right"></view>
</view>

<!-- é¡µé¢å†…å®¹ -->
<view class="container">
  
  <!-- è¯¾ç¨‹ç±»å‹åˆ‡æ¢ -->
  <view class="course-tabs">
    <view class="tab-item {{currentTab === 'private' ? 'active' : ''}}" 
          bindtap="switchTab" 
          data-tab="private">
      <text class="tab-text">ç§æ•™è¯¾</text>
      <view wx:if="{{privateCourses.length > 0}}" class="tab-count">{{privateCourses.length}}</view>
    </view>
    <view class="tab-item {{currentTab === 'group' ? 'active' : ''}}" 
          bindtap="switchTab" 
          data-tab="group">
      <text class="tab-text">å›¢è¯¾</text>
      <view wx:if="{{groupCourses.length > 0}}" class="tab-count">{{groupCourses.length}}</view>
    </view>
  </view>

  <!-- ç§æ•™è¯¾ç¨‹åˆ—è¡¨ -->
  <view wx:if="{{currentTab === 'private'}}">
    <view wx:if="{{privateCourses.length > 0}}" class="courses-list">
      <view class="course-item" 
            wx:for="{{privateCourses}}" 
            wx:key="_id">
        <view class="course-header">
          <view class="course-type-label private">ç§æ•™</view>
          <view class="course-status {{item.status}}">
            <text wx:if="{{item.status === 'confirmed'}}">å·²ç¡®è®¤</text>
            <text wx:elif="{{item.status === 'completed'}}">å·²å®Œæˆ</text>
            <text wx:elif="{{item.status === 'cancelled'}}">å·²å–æ¶ˆ</text>
          </view>
        </view>
        
        <view class="course-content">
          <view class="course-info">
            <view class="course-title">ç§æ•™è¯¾ç¨‹</view>
            <view class="course-time">{{item.date}} {{item.timeRange}}</view>
            <view class="student-info">
              <text class="student-name">å­¦å‘˜ï¼š{{item.studentName}}</text>
              <text class="student-phone">{{item.studentPhone}}</text>
            </view>
            <view wx:if="{{item.content}}" class="course-content-text">
              <text class="content-label">éœ€æ±‚ï¼š</text>
              <text class="content-text">{{item.content}}</text>
            </view>
          </view>
          
          <view class="course-actions">
            <view wx:if="{{item.status === 'confirmed'}}" class="action-buttons">
              <button class="action-btn complete-btn" 
                      bindtap="markAsCompleted" 
                      data-id="{{item._id}}">
                æ ‡è®°å®Œæˆ
              </button>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <view wx:else class="empty-state">
      <text class="empty-text">æš‚æ— ç§æ•™è¯¾ç¨‹</text>
    </view>
  </view>

  <!-- å›¢è¯¾è¯¾ç¨‹åˆ—è¡¨ -->
  <view wx:if="{{currentTab === 'group'}}">
    <view wx:if="{{groupCourses.length > 0}}" class="group-course-list">
      <view class="list-header">
        <view class="header-text">æˆ‘çš„å›¢è¯¾å®‰æ’ ({{groupCourses.length}}èŠ‚)</view>
        <view class="header-desc">æŒ‰æ—¥æœŸæ—¶é—´æ’åº</view>
      </view>

      <view class="group-course-item" 
            wx:for="{{groupCourses}}" 
            wx:key="_id"
            bindtap="toggleGroupCourseDetail" 
            data-index="{{index}}">
        
        <!-- è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ -->
        <view class="group-course-info">
          <view class="group-course-header">
            <view class="group-course-title">{{item.courseName}}</view>
            <view class="booking-count">
              <text class="count-number">{{item.bookedCount}}</text>
              <text class="count-label">äººå·²é¢„çº¦</text>
            </view>
          </view>
          
          <view class="group-course-details">
            <view class="detail-item">
              <text class="detail-icon">ğŸ“…</text>
              <text class="detail-text">{{item.dateDisplay}}</text>
            </view>
            <view class="detail-item">
              <text class="detail-icon">ğŸ•</text>
              <text class="detail-text">{{item.startTime}} - {{item.endTime}}</text>
            </view>

          </view>

          <!-- å±•å¼€/æ”¶èµ·å›¾æ ‡ -->
          <view class="expand-icon">
            <text class="expand-text">{{item.showDetail ? 'æ”¶èµ·' : 'æŸ¥çœ‹é¢„çº¦'}}</text>
            <text class="expand-arrow">{{item.showDetail ? 'â–²' : 'â–¼'}}</text>
          </view>
        </view>

        <!-- é¢„çº¦å­¦å‘˜åˆ—è¡¨ -->
        <view wx:if="{{item.showDetail}}" class="group-booking-list">
          <view wx:if="{{item.bookings.length === 0}}" class="no-bookings">
            <text class="no-bookings-text">æš‚æ— é¢„çº¦</text>
          </view>
          
          <view wx:else class="booking-students">
            <view class="students-header">é¢„çº¦å­¦å‘˜åˆ—è¡¨ï¼š</view>
            <view class="student-item" wx:for="{{item.bookings}}" wx:for-item="booking" wx:key="id">
              <view class="student-info">
                <view class="student-phone">{{booking.userPhone}}</view>
                <view class="booking-status-text {{booking.status}}">{{booking.statusText}}</view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <view wx:else class="empty-state">
      <text class="empty-text">æš‚æ— å›¢è¯¾å®‰æ’</text>
    </view>
  </view>

</view>
