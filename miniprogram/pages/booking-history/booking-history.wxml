<!-- 背景图 -->
<image class="global-bg" src="../../images/background.png" mode="aspectFill"/>

<!-- 自定义导航栏 -->
<view class="nav-bar">
  <view class="nav-left">
    <view class="nav-back" bindtap="navigateBack">
      <text class="back-icon">‹</text>
    </view>
  </view>
  <view class="nav-title">往期记录</view>
  <view class="nav-right"></view>
</view>

<!-- 页面内容 -->
<view class="container">
  <!-- 页面标题 -->
  <view class="page-title">我的预约记录</view>
  <view class="page-comment">按时间顺序从后往前排序</view>

  <!-- 课程列表 -->
  <view class="history-list">
    <block wx:if="{{bookingHistory.length > 0}}">
      <block wx:for="{{bookingHistory}}" wx:key="id">
        <view class="history-card">
          <image class="course-image" src="{{item.courseImage || '../../images/background.png'}}" mode="aspectFill"/>
          <view class="course-info">
            <view class="course-name">{{item.courseName || '瑜伽课程'}}</view>
            <view class="teacher-name">{{item.teacherName || '老师'}}</view>
            <view class="course-time">{{item.date}} {{item.time}}</view>
            <!-- 显示取消时间 -->
            <view wx:if="{{item.cancelTime && item.statusClass === 'cancelled'}}" class="cancel-time">
              取消时间：{{item.cancelTime}}
            </view>
          </view>
          <view class="course-status">
            <view class="status-tag {{item.statusClass}}">{{item.statusText}}</view>
            <view class="credits-info">{{item.creditsUsed}}次</view>
          </view>
        </view>
      </block>
    </block>
    
    <view wx:else class="empty-state">
      <text class="empty-text">暂无预约记录</text>
      <text class="empty-hint">快去预约您喜欢的课程吧！</text>
    </view>
  </view>

  <!-- 分页加载 -->
  <view wx:if="{{hasMore && bookingHistory.length > 0}}" class="load-more">
    <button class="load-more-btn" bindtap="loadMoreHistory" disabled="{{loading}}">
      {{loading ? '加载中...' : '加载更多'}}
    </button>
  </view>
  
  <view wx:elif="{{!hasMore && bookingHistory.length > 0}}" class="no-more">
    <text>已显示全部记录</text>
  </view>
</view>
