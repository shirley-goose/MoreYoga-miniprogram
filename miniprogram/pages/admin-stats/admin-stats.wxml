<!-- èƒŒæ™¯å›¾ -->
<image class="global-bg" src="../../images/background.png" mode="aspectFill"/>

<!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
<view class="nav-bar">
  <view class="nav-left">
    <view class="nav-back" bindtap="navigateBack">
      <text class="back-icon">â€¹</text>
    </view>
  </view>
  <view class="nav-title">å›¢è¯¾æ•°æ®ç»Ÿè®¡</view>
  <view class="nav-right"></view>
</view>

<!-- é¡µé¢å†…å®¹ -->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- è¯¾ç¨‹åˆ—è¡¨ -->
  <view wx:else class="course-list">
    <view wx:if="{{courseList.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ“…</view>
      <view class="empty-text">æš‚æ— æœªå‘ç”Ÿçš„è¯¾ç¨‹</view>
    </view>

    <view wx:else>
      <view class="list-header">
        <view class="header-text">æœªå‘ç”Ÿè¯¾ç¨‹ ({{courseList.length}}èŠ‚)</view>
        <view class="header-desc">æŒ‰æ—¥æœŸæ—¶é—´æ’åº</view>
      </view>

      <view class="course-item" wx:for="{{courseList}}" wx:key="id" bindtap="toggleCourseDetail" data-index="{{index}}">
        <!-- è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ -->
        <view class="course-info">
          <view class="course-header">
            <view class="course-title">{{item.courseName}}</view>
            <view class="booking-count">
              <text class="count-number">{{item.bookingCount}}</text>
              <text class="count-label">äººå·²é¢„çº¦</text>
            </view>
          </view>
          
          <view class="course-details">
            <view class="detail-item">
              <text class="detail-icon">ğŸ“…</text>
              <text class="detail-text">{{item.dateStr}}</text>
            </view>
            <view class="detail-item">
              <text class="detail-icon">ğŸ•</text>
              <text class="detail-text">{{item.timeStr}}</text>
            </view>
            <view class="detail-item">
              <text class="detail-icon">è€å¸ˆ:</text>
              <text class="detail-text">{{item.teacherName}}</text>
            </view>
          </view>

          <!-- å±•å¼€/æ”¶èµ·å›¾æ ‡ -->
          <view class="expand-icon">
            <text class="expand-text">{{item.showDetail ? 'æ”¶èµ·' : 'æŸ¥çœ‹é¢„çº¦'}}</text>
            <text class="expand-arrow">{{item.showDetail ? 'â–²' : 'â–¼'}}</text>
          </view>
        </view>

        <!-- é¢„çº¦å­¦å‘˜åˆ—è¡¨ -->
        <view wx:if="{{item.showDetail}}" class="booking-list">
          <view wx:if="{{item.bookings.length === 0}}" class="no-bookings">
            <text class="no-bookings-text">æš‚æ— é¢„çº¦</text>
          </view>
          
          <view wx:else class="booking-students">
            <view class="students-header">é¢„çº¦å­¦å‘˜åˆ—è¡¨ï¼š</view>
            <view class="student-item" wx:for="{{item.bookings}}" wx:for-item="booking" wx:key="id">
              <view class="student-info">
                <view class="student-name">{{booking.userName}}</view>
                <view class="student-phone">{{booking.userPhone}}</view>
              </view>
              <view class="booking-status {{booking.status}}">
                {{booking.status === 'confirmed' ? 'å·²ç¡®è®¤' : booking.status === 'pending' ? 'å¾…ç¡®è®¤' : booking.status === 'booked' ? 'å·²é¢„çº¦' : booking.status === 'cancelled' ? 'å·²å–æ¶ˆ' : booking.status}}
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
